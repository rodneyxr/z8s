kind: ZarfPackageConfig
metadata:
  name: dsop-core
  description: "Deploy DSOP Core"
  # DSOP Core is only amd64
  architecture: amd64

components:
  - name: istio
    required: true
    import:
      path: ../packages/istio

  - name: argocd
    required: true
    import:
      path: ../packages/argocd

  - name: elastic
    required: false
    import:
      path: ../packages/elastic

  # - name: dsop-core-assets
  #   description: "Git repositories and OCI images used by DSOP Core"
  #   required: true
  #   repos:
  #     - https://gitlab.com/dark-aster/argonauts.git # @1.0.0

    # images:
    #   # istio-controlplane
    #   - registry1.dso.mil/ironbank/big-bang/base:1.0.0
    #   - registry1.dso.mil/ironbank/opensource/istio/pilot:1.13.2
    #   - registry1.dso.mil/ironbank/opensource/istio/proxyv2:1.13.2
    #   - registry1.dso.mil/ironbank/opensource/istio/install-cni:1.13.2

    #   # istio-operator
    #   - registry1.dso.mil/ironbank/opensource/istio/operator:1.13.2

      # policy (OPA Gatekeeper)
      # - registry1.dso.mil/ironbank/opensource/kubernetes/kubectl:v1.22.2
      # - registry1.dso.mil/ironbank/opensource/openpolicyagent/gatekeeper:v3.7.1

      # # monitoring
      # - registry1.dso.mil/ironbank/big-bang/base:1.0.0
      # - registry1.dso.mil/ironbank/kiwigrid/k8s-sidecar:1.15.9
      # - registry1.dso.mil/ironbank/opensource/grafana/grafana:8.4.4
      # - registry1.dso.mil/ironbank/opensource/ingress-nginx/kube-webhook-certgen:v1.1.1
      # - registry1.dso.mil/ironbank/opensource/kubernetes/kube-state-metrics:v2.4.2
      # - registry1.dso.mil/ironbank/opensource/prometheus-operator/prometheus-config-reloader:v0.55.0
      # - registry1.dso.mil/ironbank/opensource/prometheus-operator/prometheus-operator:v0.55.1
      # - registry1.dso.mil/ironbank/opensource/prometheus/alertmanager:v0.23.0
      # - registry1.dso.mil/ironbank/opensource/prometheus/node-exporter:v1.3.1
      # - registry1.dso.mil/ironbank/opensource/prometheus/prometheus:v2.34.0

      # # twistlock
      # - registry1.dso.mil/ironbank/twistlock/console/console:22.01.840
      # - registry1.dso.mil/ironbank/twistlock/defender/defender:22.01.840

  # - name: big-bang-core-limited-resources
  #   description: "Deploy a lightweight version of Big Bang Core using limited resources"
  #   group: big-bang-variant
  #   manifests:
  #     - name: big-bang-config
  #       kustomizations:
  #         - "kustomization/core-light"

  - name: big-bang-core-standard
    description: "Deploy Big Bang Core with a standard configuration"
    group: big-bang-variant
    manifests:
      - name: big-bang-config
        kustomizations:
          - "kustomization/core-standard"
